# 年間行事予定カレンダー連携ツール (CreateCalendar)

このツールは、スプレッドシートで管理している年間行事予定をGoogleカレンダーに自動的に書き込むためのGoogle Apps Scriptプロジェクトです。スプレッドシートを原本として、カレンダーを常に最新の状態に保ちます。

## 主な機能

- スプレッドシートの年間行事予定をGoogleカレンダーに書き込み
- 書き込み時に指定期間内の既存の予定をすべて削除し、スプレッドシートの内容で更新
- 祝日データの行事予定への追加・削除
- 特定の曜日に毎週同じ予定を一括追加・削除
- 時間指定のある予定と終日予定の両方に対応
- **NEW!** 前期（4-9月）と後期（10-3月）に分けた書き込み機能

## 使用方法

年間行事予定表2025v7(公開用):[https://docs.google.com/spreadsheets/d/14l7Q61EO28ke3TVYzDQIA33_wg7u-gMq8X6zfSSGMS8/copy](https://docs.google.com/spreadsheets/d/14l7Q61EO28ke3TVYzDQIA33_wg7u-gMq8X6zfSSGMS8/copy)

### 初期設定

1. スプレッドシートのA1セルに西暦を入力します
2. E1セルにGoogleカレンダーIDを入力します
   - カレンダーIDはGoogleカレンダーの設定から取得できます

### メニュー機能

スプレッドシートを開くと、メニューバーに「年間行事予定」というメニューが表示されます。このメニューから以下の機能を利用できます：

- **【祝日追加】祝日を行事予定に追加**: AA列にある祝日データを行事予定に追加します
- **【祝日削除】祝日を行事予定から削除**: 行事予定から祝日データを削除します
- **【毎週追加】毎週の予定を追加**: 特定の曜日に毎週同じ予定を追加します
- **【毎週削除】毎週の予定を削除**: 特定の予定を行事予定から削除します
- **【登録】カレンダーへ書き込み実行**: 年間行事予定をカレンダーに書き込みます
- **【前期登録】前期（4-9月）書き込み実行**: 前期（4-9月）の行事予定のみをカレンダーに書き込みます
- **【後期登録】後期（10-3月）書き込み実行**: 後期（10-3月）の行事予定のみをカレンダーに書き込みます

### 前期・後期書き込み機能について

GASのタイムアウト制限により、一度に大量のデータを書き込むとエラーが発生する場合があります。そのため、年間行事予定を前期（4-9月）と後期（10-3月）に分けて書き込む機能を追加しました。

- **前期書き込み**: 4月から9月までの行事予定をカレンダーに書き込みます
- **後期書き込み**: 10月から3月までの行事予定をカレンダーに書き込みます

これにより、データ量が多い場合でもタイムアウトエラーを回避して確実に書き込みを行うことができます。

### 予定の入力方法

#### 時間指定のある予定

時間指定のある予定は、以下の形式で入力します：

```
予定名<開始時刻-終了時刻>
```

例：
- `会議<10:00-12:00>`
- `打ち合わせ<13:30-15:00>`

#### 時間指定のない予定（終日予定）

時間指定がない場合は、通常のテキストとして入力すると終日予定として登録されます。

#### 複数の予定を同じ日に入力する場合

同じ日に複数の予定を入力する場合は、カンマ（,）で区切って入力します：

```
予定1,予定2,予定3
```

例：
- `授業参観,職員会議`
- `運動会,PTA総会`
- `遠足<9:00-15:00>,職員研修`（時間指定あり・なしの混在も可能）

このように入力することで、1つのセルに複数の予定を登録できます。

## 注意事項

- カレンダーへの書き込み実行時、指定期間内の既存の予定はすべて削除されます
- 前期・後期書き込み実行時も、該当期間内の既存の予定はすべて削除されます
- 大量のデータを一度に処理する場合は、前期・後期に分けて書き込むことをお勧めします

## バージョン履歴

- ver1 (2020/02/23): 初版作成
- ver2 (2021/03/31): 1年分書込み対応
- ver3 (2021/04/01): カンマ区切りで複数日程対応
- ver4 (2021/08/18): 時間指定機能追加（<12:00-14:00>形式）
- ver5 (2021/09/05): 全角ハイフン「ー」対応
- ver5.1 (2022/02/02): 全角ハイフン「−」対応
- ver6 (2025/03/22): カレンダー同期機能強化（既存予定の削除と再同期）
- ver7 (2025/03/25): 前期・後期分割書き込み機能追加

## ライセンス

MIT License  
Copyright (c) 2025 Noboru Ando @ Aoyama Gakuin University
